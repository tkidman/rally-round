<header class="siteHeader">
  <div class="siteHeader__bar">
    <div class="navLeft navDesktopOnly">
      <div class="dropdown">
        <a class="brand" href="/index.html" aria-label="Home">
          <img class="brand__img" src="./assets/{{logo}}" alt="Logo" />
        </a>

        <div class="dropdown__menu" role="menu">
          {{#if links.series}}
            <div class="dropdown__title">— {{localization.series}} —</div>
            {{#each links.series}}
              <a class="dropdown__item" href="{{href}}">{{name}}</a>
            {{/each}}
          {{/if}}

          {{#if links.historical}}
            <div class="dropdown__title">— {{localization.historical}} —</div>
            {{#each links.historical}}
              <a class="dropdown__item" href="{{href}}">{{name}}</a>
            {{/each}}
          {{/if}}
        </div>
      </div>
    </div>

<nav class="navMain navDesktopOnly" aria-label="Primary">
  {{#if links.driver}}
    <div class="navDrop" tabindex="0">
      <button class="navBtn" type="button" aria-haspopup="true">
        {{localization.driver_standings}}
      </button>

      <div class="navMenu">
        {{#with links.driver}}
          {{#each this}}
            <a class="navLink {{#if active}}isActive{{/if}}" href="{{href}}">
              {{link}}
            </a>
          {{/each}}
        {{/with}}
      </div>
    </div>
  {{/if}}

  {{#if links.team}}
    <div class="navDrop" tabindex="0">
      <button class="navBtn" type="button" aria-haspopup="true">
        {{localization.team_standings}}
      </button>

      <div class="navMenu">
        {{#with links.team}}
          {{#each this}}
            <a class="navLink {{#if active}}isActive{{/if}}" href="{{href}}">
              {{link}}
            </a>
          {{/each}}
        {{/with}}
      </div>
    </div>
  {{/if}}

  {{#if links.fantasy}}
    <div class="navDrop" tabindex="0">
      <button class="navBtn" type="button" aria-haspopup="true">
        Fantasy JRC
      </button>

      <div class="navMenu">
        {{#with links.fantasy}}
          {{#each this}}
            <a class="navLink {{#if active}}isActive{{/if}}" href="{{href}}">
              {{link}}
            </a>
          {{/each}}
        {{/with}}
      </div>
    </div>
  {{/if}}
</nav>


    {{#if endTime}}
      <div class="navRight navDesktopOnly">
        <img
          class="flag"
          src="./assets/country-flags/{{activeCountry}}.png"
          alt="{{activeCountry}}"
        />
        <span id="countdown2" class="countdown"></span>
      </div>
    {{/if}}

    <button
      type="button"
      class="iconBtn navMobileOnly"
      aria-controls="seriesMobileNav"
      aria-label="Choose series"
      onclick="openSeriesMobileNav()"
    >
      <img class="brand__img brand__img--mobile" src="./assets/{{logo}}" alt="Logo" />
    </button>

    <div class="navTitle navMobileOnly">
      <div class="navTitle__main">{{links.active.menu}} - {{links.active.link}}</div>
      {{#if endTime}}<div id="countdown" class="countdown"></div>{{/if}}
    </div>

		<button
      type="button"
      class="iconBtn navMobileOnly"
      aria-controls="mobileNav"
      aria-label="Open menu"
      onclick="openMobileNav()"
    >
      <span class="hamburger" aria-hidden="true">☰</span>
    </button>
  </div>

  <div id="mobileNav" class="drawer" hidden>
    <nav class="drawer__content" aria-label="Mobile menu">
      {{#with links.driver}}
        {{#each this}}
          <a class="drawer__link {{#if active}}isActive{{/if}}" href="{{href}}">
            {{../../localization.driver_standings}} - {{link}}
          </a>
        {{/each}}
      {{/with}}

      {{#with links.team}}
        {{#each this}}
          <a class="drawer__link {{#if active}}isActive{{/if}}" href="{{href}}">
            {{../../localization.team_standings}} - {{link}}
          </a>
        {{/each}}
      {{/with}}

      {{#with links.overall}}
        {{#each this}}
          <a class="drawer__link {{#if active}}isActive{{/if}}" href="{{href}}">
            {{../../localization.overall}} - {{link}}
          </a>
        {{/each}}
      {{/with}}
    </nav>
  </div>

  <div id="seriesMobileNav" class="drawer" hidden>
    <div class="drawer__content">
      {{#if links.series}}
        <div class="drawer__title">— {{localization.series}} —</div>
        {{#each links.series}}
          <a class="drawer__link" href="{{href}}">{{name}}</a>
        {{/each}}
      {{/if}}

      {{#if links.historical}}
        <div class="drawer__title">— {{localization.historical}} —</div>
        {{#each links.historical}}
          <a class="drawer__link" href="{{href}}">{{name}}</a>
        {{/each}}
      {{/if}}
    </div>
  </div>

  {{#if secondary}}
    <div class="secondaryNav">
      {{#each secondary}}
        <a
          class="secondaryNav__item"
          href="./{{../links.active.name}}-{{this.eventId}}-driver-results.html"
          style="{{#if this.disableLink}}pointer-events:none;opacity:.45;{{/if}}"
        >
          <img class="secondaryNav__flag" src="./assets/country-flags/{{this.locationCode}}.png" alt="{{this.locationCode}}" />
        </a>
      {{/each}}
    </div>
  {{/if}}
</header>

{{#if endTime}}
<script>
  var countDownDate = new Date("{{endTime}}").getTime();
  var x = setInterval(function() {
    var now = new Date().getTime();
    var distance = countDownDate - now;

    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

    var text = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";

    var c1 = document.getElementById("countdown");
    var c2 = document.getElementById("countdown2");
    if (c1) c1.innerHTML = text;
    if (c2) c2.innerHTML = text;

    if (distance < 0) {
      clearInterval(x);
      if (c1) c1.innerHTML = "Event Ended";
      if (c2) c2.innerHTML = "Event Ended";
    }
  }, 1000);
</script>
{{/if}}
